(()=>{document.addEventListener("DOMContentLoaded",function(){let e=document.querySelectorAll("section[id]"),t=document.querySelectorAll("#navMenu a");function a(){let n="";e.forEach(s=>{let c=s.offsetTop-150;window.scrollY>=c&&(n=s.getAttribute("id"))}),t.forEach(s=>{s.getAttribute("href").replace("/#","")===n?s.setAttribute("aria-current","page"):s.removeAttribute("aria-current")})}window.addEventListener("scroll",a),a()});var b={Dakherstellingen:"dakherstellingen.json","Dakreiniging & Ontmossen":"dakreiniging.json","Onderhoud Platte Daken":"onderhoud-platte-daken.json"},o=document.getElementById("serviceModal"),L=document.getElementById("modalTitle"),u=document.getElementById("modalDescription"),p=document.getElementById("modalServicesList"),y=document.getElementById("modalExtraInfoList"),B=[document.getElementById("closeModal"),document.getElementById("closeModalBottom")],f=null;function v(e){let t=b[e],a=`assets/data/${t}`;f=document.activeElement,fetch(a).then(n=>{if(!n.ok)throw new Error(`Failed to load ${t}`);return n.json()}).then(n=>{L.textContent=n.title||e,u.textContent=n.body||"",p.innerHTML=(n.services||[]).map(s=>`<li>${s}</li>`).join(""),y.innerHTML=(n.extra_info||[]).map(s=>`<li>${s}</li>`).join(""),o.setAttribute("aria-hidden","false"),o.classList.remove("opacity-0","translate-y-0","pointer-events-none"),o.classList.add("opacity-100","translate-y-0"),document.body.style.overflow="hidden",setTimeout(()=>document.getElementById("closeModal").focus(),100)}).catch(n=>{L.textContent="",u.textContent="",p.innerHTML="",y.innerHTML="",o.querySelector("h3").classList.add("hidden");let s=`Er is een probleem opgetreden: ${n.message||"Onbekende fout"}`;u.innerHTML=`<p class="text-red-600 text-lg font-semibold">${s}</p>`,y.innerHTML='<li class="text-red-600 text-sm">Probeer het later opnieuw of neem contact op met de beheerder.</li>',o.setAttribute("aria-hidden","false"),o.classList.remove("opacity-0","translate-y-4","pointer-events-none"),o.classList.add("opacity-100","translate-y-0"),document.body.style.overflow="hidden",setTimeout(()=>document.getElementById("closeModal").focus(),100)})}function g(){o.classList.add("opacity-0","translate-y-4","pointer-events-none"),o.classList.remove("opacity-100","translate-y-0"),o.setAttribute("aria-hidden","true"),document.body.style.overflow="auto",f&&f.focus()}document.querySelectorAll(".card").forEach(e=>{let t=e.querySelector("h3").textContent.trim();e.setAttribute("tabindex","0"),e.setAttribute("role","button"),e.setAttribute("aria-label",`Meer informatie over ${t}`),e.addEventListener("click",()=>v(t)),e.addEventListener("keydown",a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),v(t))})});B.forEach(e=>e.addEventListener("click",g));o.addEventListener("click",e=>{o.querySelector("div.bg-white").contains(e.target)||g()});document.addEventListener("keydown",e=>{e.key==="Escape"&&o.classList.contains("opacity-100")&&g()});var m=document.getElementById("navToggle"),i=document.getElementById("navMenu");m.addEventListener("click",()=>{let e=m.getAttribute("aria-expanded")==="true";m.setAttribute("aria-expanded",String(!e)),e?(i.classList.remove("opacity-100","scale-100"),i.classList.add("opacity-0","scale-95"),setTimeout(()=>{i.classList.add("hidden")},300)):(i.classList.remove("hidden"),requestAnimationFrame(()=>{i.classList.remove("opacity-0","scale-95"),i.classList.add("opacity-100","scale-100")}))});document.querySelectorAll("#navMenu a").forEach(e=>{e.addEventListener("click",()=>{window.innerWidth<768&&(m.setAttribute("aria-expanded","false"),i.classList.remove("opacity-100","scale-100"),i.classList.add("opacity-0","scale-95"),setTimeout(()=>{i.classList.add("hidden")},300))})});var d=document.getElementById("toast"),I=document.getElementById("toast-message");function l(e,t="success"){I.textContent=e,d.classList.remove("bg-green-500","bg-red-500"),d.classList.add(t==="success"?"bg-green-500":"bg-red-500"),d.classList.add(t==="success"?"text-black":"text-white"),d.classList.remove("hidden"),requestAnimationFrame(()=>{d.classList.remove("translate-x-full","opacity-0"),d.classList.add("translate-x-0","opacity-100")}),setTimeout(()=>{d.classList.remove("translate-x-0","opacity-100"),d.classList.add("translate-x-full","opacity-0"),setTimeout(()=>{d.classList.add("hidden")},500)},4e3)}document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("contactForm");e.addEventListener("submit",function(t){t.preventDefault();let a=document.getElementById("naam"),n=document.getElementById("email"),s=document.getElementById("dienst"),c=document.getElementById("onderwerp"),r=!0;if(a.value.trim()===""?(document.getElementById("error-naam").classList.remove("hidden"),r=!1):document.getElementById("error-naam").classList.add("hidden"),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.value.trim())?document.getElementById("error-email").classList.add("hidden"):(document.getElementById("error-email").classList.remove("hidden"),r=!1),s.value?document.getElementById("error-dienst").classList.add("hidden"):(document.getElementById("error-dienst").classList.remove("hidden"),r=!1),c.value.trim().length<5?(document.getElementById("error-onderwerp").classList.remove("hidden"),r=!1):document.getElementById("error-onderwerp").classList.add("hidden"),!r){l("Controleer de invoervelden aub.","error");return}let h=new FormData(e);fetch(e.action,{method:"POST",body:h,headers:{Accept:"application/json"}}).then(E=>{E.ok?(e.reset(),l("Bedankt! Je aanvraag is verzonden.","success")):l("Er ging iets mis. Probeer het opnieuw.","error")}).catch(()=>{l("Verbindingsfout. Probeer het later opnieuw.","error")})})});})();
